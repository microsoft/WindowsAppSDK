parameters:
  artifactName: 'reunion_binaries'

steps:
  - task: powershell@2
    displayName: 'Copy files to staging dir'
    inputs:
      targetType: filePath
      filePath: build\CopyFilesToStagingDir.ps1
      arguments: -BuildOutputDir '$(buildOutputDir)' -OverrideDir '$(solutionPath)\build\override' -PublishDir '$(Build.ArtifactStagingDirectory)\${{ parameters.artifactName }}' -NugetDir '$(Build.ArtifactStagingDirectory)\FullNuget' -Platform '$(buildPlatform)' -Configuration '$(buildConfiguration)'

  - script: |
      dir /s $(Build.ArtifactStagingDirectory)
    displayName: HK

  - script: |
      dir /s $(buildOutputDir)
    displayName: HK

  - script: |
      dir /s
    displayName: HK

  - task: PublishBuildArtifacts@1
    displayName: 'Publish artifact: ${{ parameters.artifactName }}'
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)\${{ parameters.artifactName }}'
      artifactName: ${{ parameters.artifactName }}

  - task: PublishBuildArtifacts@1
    displayName: 'Publish artifact: Full Nuget (Reunion DLLs)'
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)\FullNuget'
      artifactName: FullNuget
